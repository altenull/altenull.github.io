<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    
    <title>웹앱 매니페스트 &amp; 서비스워커(Web App Manifest &amp; Service Worker) | Altenull&#39;s Blog</title>
    
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
        <meta name="keywords" content="PWA,Web App Manifest,Service Worker" />
    
    <meta name="description" content="이전 포스트에서 프로그레시브 웹앱(Progressive Web Apps)은 웹과 네이티브 앱이 가진 단점을 개선하는 새로운 형태의 웹앱이라고 설명드렸습니다. 그렇다면, 어떻게 PWA를 개발할 수 있을까요..? 어떠한 웹앱이 PWA가 되기 위해선 여러가지 조건을 충족하여야 하는데요. 그중에서도 특히 웹앱 매니페스트(Web App Manifest)와 서비스">
<meta name="keywords" content="PWA,Web App Manifest,Service Worker">
<meta property="og:type" content="article">
<meta property="og:title" content="웹앱 매니페스트 &amp; 서비스워커(Web App Manifest &amp; Service Worker)">
<meta property="og:url" content="http://altenull.github.io/2018/03/09/웹앱-매니페스트-서비스워커-Web-App-Manifest-Service-Worker/index.html">
<meta property="og:site_name" content="Altenull&#39;s Blog">
<meta property="og:description" content="이전 포스트에서 프로그레시브 웹앱(Progressive Web Apps)은 웹과 네이티브 앱이 가진 단점을 개선하는 새로운 형태의 웹앱이라고 설명드렸습니다. 그렇다면, 어떻게 PWA를 개발할 수 있을까요..? 어떠한 웹앱이 PWA가 되기 위해선 여러가지 조건을 충족하여야 하는데요. 그중에서도 특히 웹앱 매니페스트(Web App Manifest)와 서비스">
<meta property="og:locale" content="ko">
<meta property="og:image" content="http://altenull.github.io/images/thumbnails/thumbnail3.png">
<meta property="og:updated_time" content="2018-03-13T17:01:53.381Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="웹앱 매니페스트 &amp; 서비스워커(Web App Manifest &amp; Service Worker)">
<meta name="twitter:description" content="이전 포스트에서 프로그레시브 웹앱(Progressive Web Apps)은 웹과 네이티브 앱이 가진 단점을 개선하는 새로운 형태의 웹앱이라고 설명드렸습니다. 그렇다면, 어떻게 PWA를 개발할 수 있을까요..? 어떠한 웹앱이 PWA가 되기 위해선 여러가지 조건을 충족하여야 하는데요. 그중에서도 특히 웹앱 매니페스트(Web App Manifest)와 서비스">
<meta name="twitter:image" content="http://altenull.github.io/images/thumbnails/thumbnail3.png">
    
    <link rel="canonical" href="http://altenull.github.io/2018/03/09/웹앱-매니페스트-서비스워커-web-app-manifest-service-worker/"/>

    

    
        <link rel="icon" href="/css/images/favicon.png" />
    

    <link rel="stylesheet" href="/libs/font-awesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="/libs/titillium-web/styles.css">
    <link rel="stylesheet" href="/libs/source-code-pro/styles.css">

    <link rel="stylesheet" href="/css/style.css">

    <script src="/libs/jquery/2.0.3/jquery.min.js"></script>
    
    
        <link rel="stylesheet" href="/libs/lightgallery/css/lightgallery.min.css">
    
    
        <link rel="stylesheet" href="/libs/justified-gallery/justifiedGallery.min.css">
    
    
        <script type="text/javascript">
(function(i,s,o,g,r,a,m) {i['GoogleAnalyticsObject']=r;i[r]=i[r]||function() {
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-113144364-3', 'auto');
ga('send', 'pageview');

</script>
    
    


</head>

<body>
    <div id="wrap">
        <header id="header">
    <div id="header-outer" class="outer">
        <div class="container">
            <div class="container-inner">
                <div id="header-title">
                    <h1 class="logo-wrap">
                        <a href="/" class="logo"></a>
                    </h1>
                    
                        <h2 class="subtitle-wrap">
                            <p class="subtitle">IT Blog</p>
                        </h2>
                    
                </div>
                <div id="header-inner" class="nav-container">
                    <a id="main-nav-toggle" class="nav-icon fa fa-bars"></a>
                    <div class="nav-container-inner">
                        <ul id="main-nav">
                            
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="/">홈</a>
                                </li>
                            
                                        <ul class="main-nav-list"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Life/">Life</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Life/생각그릇/">생각그릇</a></li></ul></li><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Web/">Web</a><ul class="main-nav-list-child"><li class="main-nav-list-item"><a class="main-nav-list-link" href="/categories/Web/PWA/">PWA</a></li></ul></li></ul>
                                    
                                <li class="main-nav-list-item" >
                                    <a class="main-nav-list-link" href="https://about.me/heonyoungKim">About</a>
                                </li>
                            
                        </ul>
                        <nav id="sub-nav">
                            <div id="search-form-wrap">

    <form class="search-form">
        <input type="text" class="ins-search-input search-form-input" placeholder="검색" />
        <button type="submit" class="search-form-submit"></button>
    </form>
    <div class="ins-search">
    <div class="ins-search-mask"></div>
    <div class="ins-search-container">
        <div class="ins-input-wrapper">
            <input type="text" class="ins-search-input" placeholder="Type something..." />
            <span class="ins-close ins-selectable"><i class="fa fa-times-circle"></i></span>
        </div>
        <div class="ins-section-wrapper">
            <div class="ins-section-container"></div>
        </div>
    </div>
</div>
<script>
(function (window) {
    var INSIGHT_CONFIG = {
        TRANSLATION: {
            POSTS: '포스트',
            PAGES: 'Pages',
            CATEGORIES: '카테고리',
            TAGS: '태그',
            UNTITLED: '(Untitled)',
        },
        ROOT_URL: '/',
        CONTENT_URL: '/content.json',
    };
    window.INSIGHT_CONFIG = INSIGHT_CONFIG;
})(window);
</script>
<script src="/js/insight.js"></script>

</div>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </div>
</header>
        <div class="container">
            <div class="main-body container-inner">
                <div class="main-body-inner">
                    <section id="main">
                        <div class="main-body-header">
    <h1 class="header">
    
    <a class="page-title-link" href="/categories/Web/">Web</a><i class="icon fa fa-angle-right"></i><a class="page-title-link" href="/categories/Web/PWA/">PWA</a>
    </h1>
</div>
                        <div class="main-body-content">
                            <article id="post-웹앱-매니페스트-서비스워커-Web-App-Manifest-Service-Worker" class="article article-single article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
            <header class="article-header">
                
    
        <h1 class="article-title" itemprop="name">
        웹앱 매니페스트 &amp; 서비스워커(Web App Manifest &amp; Service Worker)
        </h1>
    

            </header>
        
        
            <div class="article-meta">
                
    <div class="article-date">
        <a href="/2018/03/09/웹앱-매니페스트-서비스워커-Web-App-Manifest-Service-Worker/" class="article-date">
            <time datetime="2018-03-09T12:10:07.000Z" itemprop="datePublished">2018-03-09</time>
        </a>
    </div>

                
    <div class="article-tag">
        <i class="fa fa-tag"></i>
        <a class="tag-link" href="/tags/PWA/">PWA</a>, <a class="tag-link" href="/tags/Service-Worker/">Service Worker</a>, <a class="tag-link" href="/tags/Web-App-Manifest/">Web App Manifest</a>
    </div>

            </div>
        
        
        <div class="article-entry" itemprop="articleBody">
            <p align="center"><img src="/images/thumbnails/thumbnail3.png" width="600"></p>

<p>이전 포스트에서 프로그레시브 웹앱(Progressive Web Apps)은 웹과 네이티브 앱이 가진 단점을 개선하는 새로운 형태의 웹앱이라고 설명드렸습니다.</p>
<p>그렇다면, 어떻게 PWA를 개발할 수 있을까요..?</p>
<p>어떠한 웹앱이 PWA가 되기 위해선 여러가지 조건을 충족하여야 하는데요. 그중에서도 특히 웹앱 매니페스트(Web App Manifest)와 서비스워커(Service Worker)는 필수적으로 포함되어야하는 요소입니다. 더 자세히 알아보도록 하겠습니다.</p>
<p>이를 위해 <a href="https://github.com/facebook/create-react-app" target="_blank" rel="noopener">create-react-app</a>으로 프로젝트를 생성하여 진행해보도록 하겠습니다. React 개발환경을 쉽게 구성할 수 있는 create-react-app에는 이미 웹 매니페스트, 서비스워커 등이 상당 부분 구현되어 있어서 이해하기가 훨씬 수월할 것입니다.</p>
<hr>
<h1 id="create-react-app-프로젝트-생성"><a href="#create-react-app-프로젝트-생성" class="headerlink" title="create-react-app 프로젝트 생성"></a>create-react-app 프로젝트 생성</h1><p>먼저 create-react-app으로 react-pwa라는 샘플 프로젝트를 생성합니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">create-react-app react-pwa</span><br></pre></td></tr></table></figure>
<p>위 명령어를 실행하고 나면 react-pwa 폴더가 생성됩니다. 그리고 이 폴더를 열어보면 다음과 같이 프로젝트가 구성되어 있는데요. 여기서 주목해야 할 것은 <code>manifest.json</code>과 <code>registerServiceWorker.js</code> 입니다.</p>
<p align="center"><img src="/images/pwa/react-pwa.png" style="box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);"></p>

<p>먼저 웹앱 매니페스트(Web App Manifest)부터 알아보겠습니다.</p>
<hr>
<h1 id="웹앱-매니페스트-Web-App-Manifest"><a href="#웹앱-매니페스트-Web-App-Manifest" class="headerlink" title="웹앱 매니페스트(Web App Manifest)"></a>웹앱 매니페스트(Web App Manifest)</h1><p>웹앱 매니페스트란 앱에 대한 정보를 담고 JSON 파일입니다. 배경색은 어떠한 색인지, 앱의 이름은 무엇인지, 홈스크린 화면에 추가할 때 아이콘은 어떤 것인지 등의 정보를 담고 있죠. 웹앱 매니페스트는 <code>manifest.json</code> 파일명을 대부분 사용합니다.</p>
<p><strong><em>manifest.json</em></strong></p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">"short_name"</span>: <span class="string">"React App"</span>,</span><br><span class="line">  <span class="attr">"name"</span>: <span class="string">"Create React App Sample"</span>,</span><br><span class="line">  <span class="attr">"icons"</span>: [</span><br><span class="line">    &#123;</span><br><span class="line">      <span class="attr">"src"</span>: <span class="string">"favicon.ico"</span>,</span><br><span class="line">      <span class="attr">"sizes"</span>: <span class="string">"64x64 32x32 24x24 16x16"</span>,</span><br><span class="line">      <span class="attr">"type"</span>: <span class="string">"image/x-icon"</span></span><br><span class="line">    &#125;</span><br><span class="line">  ],</span><br><span class="line">  <span class="attr">"start_url"</span>: <span class="string">"./index.html"</span>,</span><br><span class="line">  <span class="attr">"display"</span>: <span class="string">"standalone"</span>,</span><br><span class="line">  <span class="attr">"theme_color"</span>: <span class="string">"#000000"</span>,</span><br><span class="line">  <span class="attr">"background_color"</span>: <span class="string">"#ffffff"</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>항목별 설명</strong></p>
<ul>
<li><strong>short_name</strong>: 사용자 홈 화면에서 아이콘 이름으로 사용</li>
<li><strong>name</strong>: 웹앱 설치 배너에 사용</li>
<li><strong>icons</strong>: 홈 화면에 추가할때 사용할 이미지</li>
<li><strong>start_url</strong>: 웹앱 실행시 시작되는 URL 주소</li>
<li><strong>display</strong>: 디스플레이 유형(fullscreen, standalone, browser 중 설정)</li>
<li><strong>theme_color</strong>: 상단 툴바의 색상</li>
<li><strong>background_color</strong>: 스플래시 화면 배경 색상</li>
<li><strong>orientation</strong>: 특정 방향을 강제로 지정(landscape, portrait 중 설정)</li>
</ul>
<hr>
<h1 id="서비스워커-Service-Worker"><a href="#서비스워커-Service-Worker" class="headerlink" title="서비스워커(Service Worker)"></a>서비스워커(Service Worker)</h1><p>서비스워커는 브라우저의 백그라운드에서 실행되는 자바스크립트 워커입니다. PWA는 네이티브 앱처럼 오프라인 상태에서도 사용가능하고, 푸시 알림(Notification) 기능도 사용할 수 있는데요. 이런 기능을 할 수 있도록 도와주는 것이 바로 서비스워커입니다. 향후에는 서비스워커에 <a href="https://developers.google.com/location-context/geofencing/" target="_blank" rel="noopener">지오펜싱(Geofencing)</a>과 같은 기능이 추가될 예정이라고 합니다.</p>
<h4 id="생명주기-Life-Cycle"><a href="#생명주기-Life-Cycle" class="headerlink" title="생명주기(Life Cycle)"></a>생명주기(Life Cycle)</h4><p>서비스워커는 다음과 같은 생명주기를 가집니다.</p>
<p align="center"><img src="/images/pwa/sw-lifecycle.png" width="680" style="box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);"></p>

<p>서비스워커를 설치하기 위해서는 먼저 등록을 해야하는데요. 서비스워커 등록 코드는 <code>registerServiceWorker.js</code>에 이미 구현이 되어있습니다. 등록을 하게 되면 브라우저가 백그라운드에서 서비스워커 설치를 시작하게 됩니다. 설치단계 동안에는 정적자원을 캐싱하는 작업을 진행하게 되고, 모든 정적자원의 캐싱이 완료되면 비로소 서비스워커 설치가 끝납니다. 이렇게 서비스워커가 설치 되고, 활성화되고 나면 비로소 서비스워커가 기능을 할 수 있게됩니다.</p>
<h4 id="서비스워커-등록-과정"><a href="#서비스워커-등록-과정" class="headerlink" title="서비스워커 등록 과정"></a>서비스워커 등록 과정</h4><p><code>registerServiceWorker.js</code>에 구현되어 있는 <code>register()</code>, <code>registerValidSW()</code> 함수입니다.</p>
<p><strong><em>registerServiceWorker.js</em></strong><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line">(...)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'production'</span> &amp;&amp; <span class="string">'serviceWorker'</span> <span class="keyword">in</span> navigator) &#123;</span><br><span class="line">    <span class="comment">// The URL constructor is available in all browsers that support SW.</span></span><br><span class="line">    <span class="keyword">const</span> publicUrl = <span class="keyword">new</span> URL(process.env.PUBLIC_URL, <span class="built_in">window</span>.location);</span><br><span class="line">    <span class="keyword">if</span> (publicUrl.origin !== <span class="built_in">window</span>.location.origin) &#123;</span><br><span class="line">      <span class="comment">// Our service worker won't work if PUBLIC_URL is on a different origin</span></span><br><span class="line">      <span class="comment">// from what our page is served on. This might happen if a CDN is used to</span></span><br><span class="line">      <span class="comment">// serve assets; see https://github.com/facebookincubator/create-react-app/issues/2374</span></span><br><span class="line">      <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">window</span>.addEventListener(<span class="string">'load'</span>, () =&gt; &#123;</span><br><span class="line">      <span class="keyword">const</span> swUrl = <span class="string">`<span class="subst">$&#123;process.env.PUBLIC_URL&#125;</span>/service-worker.js`</span>;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">if</span> (isLocalhost) &#123;</span><br><span class="line">        <span class="comment">// This is running on localhost. Lets check if a service worker still exists or not.</span></span><br><span class="line">        checkValidServiceWorker(swUrl);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Add some additional logging to localhost, pointing developers to the</span></span><br><span class="line">        <span class="comment">// service worker/PWA documentation.</span></span><br><span class="line">        navigator.serviceWorker.ready.then(<span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="built_in">console</span>.log(</span><br><span class="line">            <span class="string">'This web app is being served cache-first by a service '</span> +</span><br><span class="line">              <span class="string">'worker. To learn more, visit https://goo.gl/SC7cgQ'</span></span><br><span class="line">          );</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Is not local host. Just register service worker</span></span><br><span class="line">        registerValidSW(swUrl);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">registerValidSW</span>(<span class="params">swUrl</span>) </span>&#123;</span><br><span class="line">  navigator.serviceWorker</span><br><span class="line">    .register(swUrl)</span><br><span class="line">    .then(<span class="function"><span class="params">registration</span> =&gt;</span> &#123;</span><br><span class="line">      registration.onupdatefound = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">const</span> installingWorker = registration.installing;</span><br><span class="line">        installingWorker.onstatechange = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="keyword">if</span> (installingWorker.state === <span class="string">'installed'</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (navigator.serviceWorker.controller) &#123;</span><br><span class="line">              <span class="comment">// At this point, the old content will have been purged and</span></span><br><span class="line">              <span class="comment">// the fresh content will have been added to the cache.</span></span><br><span class="line">              <span class="comment">// It's the perfect time to display a "New content is</span></span><br><span class="line">              <span class="comment">// available; please refresh." message in your web app.</span></span><br><span class="line">              <span class="built_in">console</span>.log(<span class="string">'New content is available; please refresh.'</span>);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">              <span class="comment">// At this point, everything has been precached.</span></span><br><span class="line">              <span class="comment">// It's the perfect time to display a</span></span><br><span class="line">              <span class="comment">// "Content is cached for offline use." message.</span></span><br><span class="line">              <span class="built_in">console</span>.log(<span class="string">'Content is cached for offline use.'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">      &#125;;</span><br><span class="line">    &#125;)</span><br><span class="line">    .catch(<span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.error(<span class="string">'Error during service worker registration:'</span>, error);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br><span class="line">(...)</span><br></pre></td></tr></table></figure></p>
<p><code>register()</code>, <code>registerValidSW()</code> 두 함수에 서비스워커 등록이 잘 되는지 파악하기 위해 <code>console.log()</code> 함수를 각각 추가해보겠습니다.</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">(...)</span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> <span class="function"><span class="keyword">function</span> <span class="title">register</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">  <span class="keyword">if</span> (process.env.NODE_ENV === <span class="string">'production'</span> &amp;&amp; <span class="string">'serviceWorker'</span> <span class="keyword">in</span> navigator) &#123;</span><br><span class="line">    (...)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123; <span class="comment">// 이곳! (else문 추가)</span></span><br><span class="line">    <span class="built_in">console</span>.log(<span class="string">"won't register serviceWorker. Current env:"</span>, process.env.NODE_ENV);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">registerValidSW</span>(<span class="params">swUrl</span>) </span>&#123;</span><br><span class="line">  navigator.serviceWorker</span><br><span class="line">    .register(swUrl)</span><br><span class="line">    .then(<span class="function"><span class="params">registration</span> =&gt;</span> &#123;</span><br><span class="line">      <span class="built_in">console</span>.log(<span class="string">'serviceWorker is registered'</span>); <span class="comment">// 이곳!</span></span><br><span class="line">      registration.onupdatefound = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    (...)</span><br><span class="line">&#125;</span><br><span class="line">(...)</span><br></pre></td></tr></table></figure>
<p>수정이 완료되고 나면 다음 명령어로 프로젝트를 실행해봅니다.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yarn start</span><br><span class="line">혹은</span><br><span class="line">npm run start</span><br></pre></td></tr></table></figure>
<p>성공적으로 실행하고 나면, 크롬 브라우저를 열고 <code>localhost:3000</code>에 접속한 뒤, console 창을 확인합니다. 그러면 development 레벨이기 때문에 서비스워커를 등록할 수 없다는 메시지를 확인할 수 있습니다.</p>
<p align="center"><img src="/images/pwa/CRA-practice-01.png" width="680" style="box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);"></p>

<p>프로젝트를 production 레벨로 실행하기 위하여 <code>yarn build</code> 혹은 <code>npm run build</code> 명령어로 빌드를 하고 파이어베이스로 호스팅해보았습니다.(과정 생략)<br>호스팅을 한 링크로 접속하고 console 창을 확인해보면 다음과 같이 서비스워커가 등록되었다는 메시지를 확인할 수 있습니다.(<a href="https://react-pwa-altenull.firebaseapp.com/" target="_blank" rel="noopener">호스팅 링크</a>)</p>
<p align="center"><img src="/images/pwa/CRA-practice-02.png" width="680" style="box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);"></p>

<p>실제 서비스워커는 개발자도구(F12)의 Application 탭에서 Service Workers 메뉴에서 확인가능 합니다.</p>
<p align="center"><img src="/images/pwa/CRA-practice-03.png" width="680" style="box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);"></p>

<h4 id="정적-자원-캐싱"><a href="#정적-자원-캐싱" class="headerlink" title="정적 자원 캐싱"></a>정적 자원 캐싱</h4><p>서비스워커 설치단계에서는 정적 자원을 캐싱한다고 설명드렸습니다. 캐싱이 완료되고 나면 어떠한 일이 벌어지는지 알아보겠습니다.</p>
<p><strong>최초 접속</strong><br>파이어베이스로 호스팅을 하고 난 뒤, 최초 접속했을 때에 Network 탭 화면입니다. 번들링된 css, js 파일 등을 서버로부터 다운로드하는데요. Size와 Time부분을 주목해주세요.</p>
<p align="center"><img src="/images/pwa/CRA-practice-04.png" width="680" style="box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);"></p>

<p><strong>재접속</strong><br>다음은 새로고침(F5)을 하고 나서 캡처한 Network 탭 화면입니다. Size와 Time이 이전과 많이 달라졌네요. 시간은 크게 줄어들었고, 특히 Size가 (from ServiceWorker)로 바뀌었습니다.</p>
<p align="center"><img src="/images/pwa/CRA-practice-05.png" width="680" style="box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);"></p>

<p>서비스워커는 설치되고 나면 브라우저와 서버 중간에 위치해 브라우저에서 보내는 요청들을 검사합니다. 이 때 요청에 대한 응답, 즉 자원이 캐싱되어 있다면 굳이 서버에서 받을 필요 없이 캐싱된 자원을 리턴합니다. 그렇기 때문에 응답시간도 현저히 줄어든 것입니다.</p>
<p><strong>Network Disconnect</strong></p>
<p>이번에는 네트워크 연결을 해제하고 접속해보겠습니다. 사용중인 와이파이를 꺼주시거나, 개발자도구(F12) - Application - Service Workers에서 offline을 체크하고 다시 접속해봅니다.</p>
<p>그러면 404 Not Found가 뜨지 않고 네트워크가 연결되어 있을 때와 동일한 페이지를 보실 수 있으실 겁니다. 왜냐하면 지금 보여지고 있는 자원들은 서버에서 받은 자원이 아닌 서비스워커로부터 받은 캐싱된 자원이기 때문입니다.</p>
<p align="center"><img src="/images/pwa/CRA-practice-06.png" width="680" style="box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);"></p>

<hr>
<h1 id="마치며"><a href="#마치며" class="headerlink" title="마치며"></a>마치며</h1><p>이번 포스트에서는 웹앱 매니페스트(Web App Manifest)와 서비스워커(Service Worker)에 대해서 간략하게 알아보았습니다. PWA를 처음 접하시는 분들에게 조금이나마 도움이 되셨으면 좋겠습니다.</p>
<hr>
<h1 id="참고"><a href="#참고" class="headerlink" title="참고"></a>참고</h1><ul>
<li><a href="https://developers.google.com/web/fundamentals/primers/service-workers/" target="_blank" rel="noopener">Google Developers - Service Workers</a></li>
<li><a href="https://developers.google.com/web/fundamentals/web-app-manifest/" target="_blank" rel="noopener">Google Developers - Web App Manifest</a></li>
<li><a href="https://developers.google.com/web/fundamentals/app-install-banners/?hl=ko" target="_blank" rel="noopener">Google Developers - App Install Banners</a></li>
</ul>
<p><div style="display: flex; justify-content: center;"><div class="github-card" data-github="altenull" data-width="400" data-height="" data-theme="default"></div></div></p>
<script src="//cdn.jsdelivr.net/github-cards/latest/widget.js"></script>
        </div>
        <footer class="article-footer">
            



    <a data-url="http://altenull.github.io/2018/03/09/웹앱-매니페스트-서비스워커-Web-App-Manifest-Service-Worker/" data-id="cjepwmgkf0000yctu9j9euwtc" class="article-share-link"><i class="fa fa-share"></i>공유하기</a>
<script>
    (function ($) {
        $('body').on('click', function() {
            $('.article-share-box.on').removeClass('on');
        }).on('click', '.article-share-link', function(e) {
            e.stopPropagation();

            var $this = $(this),
                url = $this.attr('data-url'),
                encodedUrl = encodeURIComponent(url),
                id = 'article-share-box-' + $this.attr('data-id'),
                offset = $this.offset(),
                box;

            if ($('#' + id).length) {
                box = $('#' + id);

                if (box.hasClass('on')){
                    box.removeClass('on');
                    return;
                }
            } else {
                var html = [
                    '<div id="' + id + '" class="article-share-box">',
                        '<input class="article-share-input" value="' + url + '">',
                        '<div class="article-share-links">',
                            '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
                            '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
                            '<a href="http://pinterest.com/pin/create/button/?url=' + encodedUrl + '" class="article-share-pinterest" target="_blank" title="Pinterest"></a>',
                            '<a href="https://plus.google.com/share?url=' + encodedUrl + '" class="article-share-google" target="_blank" title="Google+"></a>',
                        '</div>',
                    '</div>'
                ].join('');

              box = $(html);

              $('body').append(box);
            }

            $('.article-share-box.on').hide();

            box.css({
                top: offset.top + 25,
                left: offset.left
            }).addClass('on');

        }).on('click', '.article-share-box', function (e) {
            e.stopPropagation();
        }).on('click', '.article-share-box-input', function () {
            $(this).select();
        }).on('click', '.article-share-box-link', function (e) {
            e.preventDefault();
            e.stopPropagation();

            window.open(this.href, 'article-share-box-window-' + Date.now(), 'width=500,height=450');
        });
    })(jQuery);
</script>

        </footer>
    </div>
</article>

    <section id="comments">
    
        
    <div id="disqus_thread">
        <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>

    
    </section>


                        </div>
                    </section>
                    <aside id="sidebar">
    <a class="sidebar-toggle" title="Expand Sidebar"><i class="toggle icon"></i></a>
    <div class="sidebar-top">
        <p>팔로우:</p>
        <ul class="social-links">
            
                
                <li>
                    <a class="social-tooltip" title="github" href="https://github.com/altenull" target="_blank">
                        <i class="icon fa fa-github"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="linkedin" href="https://www.linkedin.com/in/heonyoungkim" target="_blank">
                        <i class="icon fa fa-linkedin"></i>
                    </a>
                </li>
                
            
                
                <li>
                    <a class="social-tooltip" title="envelope" href="mailto:altenull@gmail.com" target="_blank">
                        <i class="icon fa fa-envelope"></i>
                    </a>
                </li>
                
            
        </ul>
    </div>
    
        
<nav id="article-nav">
    
    
        <a href="/2018/02/25/프로그레시브-웹-앱-Progressive-Web-Apps-란/" id="article-nav-older" class="article-nav-link-wrap">
        <strong class="article-nav-caption">오래된</strong>
        <p class="article-nav-title">프로그레시브 웹앱(Progressive Web Apps)이란?</p>
        <i class="icon fa fa-chevron-left" id="icon-chevron-left"></i>
        </a>
    
</nav>

    
    <div class="widgets-container">
        
            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">카테고리</h3>
        <div class="widget">
            <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Life/">Life</a><span class="category-list-count">1</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Life/생각그릇/">생각그릇</a><span class="category-list-count">1</span></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/Web/">Web</a><span class="category-list-count">2</span><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/Web/PWA/">PWA</a><span class="category-list-count">2</span></li></ul></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap">
        <h3 class="widget-title">최근 글</h3>
        <div class="widget">
            <ul id="recent-post" class="">
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/03/09/웹앱-매니페스트-서비스워커-Web-App-Manifest-Service-Worker/" class="thumbnail">
    
    
        <span style="background-image:url(/images/thumbnails/thumbnail3.png)" alt="웹앱 매니페스트 &amp; 서비스워커(Web App Manifest &amp; Service Worker)" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Web/">Web</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Web/PWA/">PWA</a></p>
                            <p class="item-title"><a href="/2018/03/09/웹앱-매니페스트-서비스워커-Web-App-Manifest-Service-Worker/" class="title">웹앱 매니페스트 &amp; 서비스워커(Web App Manifest &amp; Service Worker)</a></p>
                            <p class="item-date"><time datetime="2018-03-09T12:10:07.000Z" itemprop="datePublished">2018-03-09</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/02/25/프로그레시브-웹-앱-Progressive-Web-Apps-란/" class="thumbnail">
    
    
        <span style="background-image:url(/images/thumbnails/thumbnail2.png)" alt="프로그레시브 웹앱(Progressive Web Apps)이란?" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Web/">Web</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Web/PWA/">PWA</a></p>
                            <p class="item-title"><a href="/2018/02/25/프로그레시브-웹-앱-Progressive-Web-Apps-란/" class="title">프로그레시브 웹앱(Progressive Web Apps)이란?</a></p>
                            <p class="item-date"><time datetime="2018-02-25T14:23:56.000Z" itemprop="datePublished">2018-02-25</time></p>
                        </div>
                    </li>
                
                    <li>
                        
                        <div class="item-thumbnail">
                            <a href="/2018/02/19/Hexo-블로그-개설/" class="thumbnail">
    
    
        <span style="background-image:url(/images/thumbnails/firstThumb.png)" alt="Hexo 블로그 개설!" class="thumbnail-image"></span>
    
    
</a>

                        </div>
                        
                        <div class="item-inner">
                            <p class="item-category"><a class="article-category-link" href="/categories/Life/">Life</a><i class="icon fa fa-angle-right"></i><a class="article-category-link" href="/categories/Life/생각그릇/">생각그릇</a></p>
                            <p class="item-title"><a href="/2018/02/19/Hexo-블로그-개설/" class="title">Hexo 블로그 개설!</a></p>
                            <p class="item-date"><time datetime="2018-02-19T08:24:32.000Z" itemprop="datePublished">2018-02-19</time></p>
                        </div>
                    </li>
                
            </ul>
        </div>
    </div>

            
                
    <div class="widget-wrap widget-list">
        <h3 class="widget-title">아카이브</h3>
        <div class="widget">
            <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">3월 2018</a><span class="archive-list-count">1</span></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/02/">2월 2018</a><span class="archive-list-count">2</span></li></ul>
        </div>
    </div>


            
                
    <div class="widget-wrap widget-float">
        <h3 class="widget-title">태그 클라우드</h3>
        <div class="widget tagcloud">
            <a href="/tags/BLOG/" style="font-size: 10px;">BLOG</a> <a href="/tags/HEXO/" style="font-size: 10px;">HEXO</a> <a href="/tags/PROGRESSIVE-WEB-APPS/" style="font-size: 10px;">PROGRESSIVE WEB APPS</a> <a href="/tags/PWA/" style="font-size: 20px;">PWA</a> <a href="/tags/Service-Worker/" style="font-size: 10px;">Service Worker</a> <a href="/tags/Web-App-Manifest/" style="font-size: 10px;">Web App Manifest</a> <a href="/tags/프로그레시브-웹앱/" style="font-size: 10px;">프로그레시브 웹앱</a>
        </div>
    </div>


            
        
    </div>
</aside>
                </div>
            </div>
        </div>
        <footer id="footer">
    <div class="container">
        <div class="container-inner">
            <a id="back-to-top" href="javascript:;"><i class="icon fa fa-angle-up"></i></a>
            <div class="credit">
                <h1 class="logo-wrap">
                    <a href="/" class="logo"></a>
                </h1>
                <p>&copy; 2018 altenull</p>
                <p>Powered by <a href="//hexo.io/" target="_blank">Hexo</a>. Theme by <a href="//github.com/ppoffice" target="_blank">PPOffice</a></p>
            </div>
        </div>
    </div>
</footer>
        
    
    <script>
    var disqus_shortname = 'altenull';
    
    
    var disqus_url = 'http://altenull.github.io/2018/03/09/웹앱-매니페스트-서비스워커-Web-App-Manifest-Service-Worker/';
    
    (function() {
    var dsq = document.createElement('script');
    dsq.type = 'text/javascript';
    dsq.async = true;
    dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
    </script>




    
        <script src="/libs/lightgallery/js/lightgallery.min.js"></script>
        <script src="/libs/lightgallery/js/lg-thumbnail.min.js"></script>
        <script src="/libs/lightgallery/js/lg-pager.min.js"></script>
        <script src="/libs/lightgallery/js/lg-autoplay.min.js"></script>
        <script src="/libs/lightgallery/js/lg-fullscreen.min.js"></script>
        <script src="/libs/lightgallery/js/lg-zoom.min.js"></script>
        <script src="/libs/lightgallery/js/lg-hash.min.js"></script>
        <script src="/libs/lightgallery/js/lg-share.min.js"></script>
        <script src="/libs/lightgallery/js/lg-video.min.js"></script>
    
    
        <script src="/libs/justified-gallery/jquery.justifiedGallery.min.js"></script>
    
    



<!-- Custom Scripts -->
<script src="/js/main.js"></script>

    </div>
</body>
</html>
